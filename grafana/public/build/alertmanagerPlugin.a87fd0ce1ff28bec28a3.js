"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6795],{"./public/app/plugins/datasource/alertmanager/module.ts":(e,t,a)=>{a.r(t),a.d(t,{plugin:()=>m});var s,n,i=a("./packages/grafana-data/src/index.ts"),r=(a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),a("./packages/grafana-ui/src/index.ts")),c=a("./public/app/plugins/datasource/alertmanager/types.ts"),o=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const l=[{value:c.sK.cortex,label:"Cortex",description:"https://cortexmetrics.io/"},{value:c.sK.prometheus,label:"Prometheus",description:"https://prometheus.io/. Does not support editing configuration via API, so contact points and notification policies are read-only."}];var u=a("./.yarn/cache/rxjs-npm-7.5.5-d0546b1ccb-e034f60805.zip/node_modules/rxjs/dist/esm5/internal/observable/of.js"),d=a("./.yarn/cache/rxjs-npm-7.5.5-d0546b1ccb-e034f60805.zip/node_modules/rxjs/dist/esm5/internal/lastValueFrom.js"),h=a("./packages/grafana-runtime/src/index.ts");class p extends i.DataSourceApi{constructor(e){super(e),this.instanceSettings=e,this.instanceSettings=e}query(){return(0,u.of)({data:[]})}_request(e){const t={headers:{},method:"GET",url:this.instanceSettings.url+e};return(this.instanceSettings.basicAuth||this.instanceSettings.withCredentials)&&(this.instanceSettings.withCredentials=!0),this.instanceSettings.basicAuth&&(t.headers.Authorization=this.instanceSettings.basicAuth),(0,d.n)((0,h.getBackendSrv)().fetch(t))}async testDatasource(){var e;let t;if(this.instanceSettings.jsonData.implementation===c.sK.prometheus){try{var a;if(t=await this._request("/alertmanager/api/v2/status"),t&&200===(null===(a=t)||void 0===a?void 0:a.status))return{status:"error",message:"It looks like you have chosen Prometheus implementation, but detected a Cortex endpoint. Please update implementation selection and try again."}}catch(e){}try{t=await this._request("/api/v2/status")}catch(e){}}else{try{var s;if(t=await this._request("/api/v2/status"),t&&200===(null===(s=t)||void 0===s?void 0:s.status))return{status:"error",message:"It looks like you have chosen Cortex implementation, but detected a Prometheus endpoint. Please update implementation selection and try again."}}catch(e){}try{t=await this._request("/alertmanager/api/v2/status")}catch(e){}}return 200===(null===(e=t)||void 0===e?void 0:e.status)?{status:"success",message:"Health check passed."}:{status:"error",message:"Health check failed."}}}const m=new i.DataSourcePlugin(p).setConfigEditor((e=>{let{options:t,onOptionsChange:a}=e;return(0,o.jsxs)(o.Fragment,{children:[s||(s=(0,o.jsx)("h3",{className:"page-heading",children:"Alertmanager"})),(0,o.jsx)("div",{className:"gf-form-group",children:(0,o.jsx)("div",{className:"gf-form-inline",children:(0,o.jsxs)("div",{className:"gf-form",children:[n||(n=(0,o.jsx)(r.InlineFormLabel,{width:13,children:"Implementation"})),(0,o.jsx)(r.Select,{width:40,options:l,value:t.jsonData.implementation||c.sK.cortex,onChange:e=>a(Object.assign({},t,{jsonData:Object.assign({},t.jsonData,{implementation:e.value})}))})]})})}),(0,o.jsx)(r.DataSourceHttpSettings,{defaultUrl:"",dataSourceConfig:t,showAccessOptions:!0,onChange:a})]})}))}}]);
//# sourceMappingURL=alertmanagerPlugin.a87fd0ce1ff28bec28a3.js.map
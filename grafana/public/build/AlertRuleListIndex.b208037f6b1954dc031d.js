"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2461,4286],{"./public/app/core/hooks/useCleanup.ts":(e,a,t)=>{t.d(a,{x:()=>l});var r=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),s=t("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/3/opt/drone/yarncache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),n=t("./public/app/core/actions/cleanUp.ts");function l(e){const a=(0,s.useDispatch)(),t=(0,r.useRef)(e);t.current=e,(0,r.useEffect)((()=>()=>{a((0,n.e)({stateSelector:t.current}))}),[a])}},"./public/app/features/alerting/AlertRuleList.tsx":(e,a,t)=>{t.r(a),t.d(a,{AlertRuleListUnconnected:()=>z,default:()=>T});var r,s=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),n=t("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/3/opt/drone/yarncache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),l=t("./packages/grafana-runtime/src/index.ts"),i=t("./packages/grafana-ui/src/index.ts"),o=t("./public/app/core/app_events.ts"),c=t("./public/app/core/components/Page/Page.tsx"),u=t("./public/app/core/selectors/navModel.ts"),d=t("./public/app/types/events.ts"),p=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");function m(e){let{onDismiss:a}=e;return(0,p.jsx)(i.Modal,{title:"Adding an Alert",isOpen:!0,onDismiss:a,onClickBackdrop:a,children:r||(r=(0,p.jsxs)(i.VerticalGroup,{spacing:"sm",children:[(0,p.jsx)("img",{src:"public/img/alert_howto_new.png",alt:"link to how to alert image"}),(0,p.jsx)("p",{children:"Alerts are added and configured in the Alert tab of any dashboard graph panel, letting you build and visualize an alert using existing queries."}),(0,p.jsx)("p",{children:"Remember to save the dashboard to persist your alert rule changes."})]}))})}var g=t("./.yarn/__virtual__/react-highlight-words-virtual-d2265e757c/3/opt/drone/yarncache/react-highlight-words-npm-0.17.0-880b4a18ed-41b3d0e451.zip/node_modules/react-highlight-words/dist/main.js"),h=t.n(g);const x=e=>{let{rule:a,search:t,onTogglePause:r}=e;const n=`${a.url}?editPanel=${a.panelId}&tab=alert`,l=(0,s.useCallback)((e=>(0,p.jsx)(h(),{highlightClassName:"highlight-search-match",textToHighlight:e,searchWords:[t]},e)),[t]);return(0,p.jsxs)(i.Card,{children:[(0,p.jsx)(i.Card.Heading,{children:l(a.name)}),(0,p.jsx)(i.Card.Figure,{children:(0,p.jsx)(i.Icon,{size:"xl",name:a.stateIcon,className:`alert-rule-item__icon ${a.stateClass}`})}),(0,p.jsxs)(i.Card.Meta,{children:[(0,p.jsxs)("span",{children:[(0,p.jsxs)("span",{className:`${a.stateClass}`,children:[l(a.stateText)," "]},"text"),"for ",a.stateAge]},"state"),a.info?l(a.info):null]}),(0,p.jsxs)(i.Card.Actions,{children:[(0,p.jsx)(i.Button,{variant:"secondary",icon:"paused"===a.state?"play":"pause",onClick:r,children:"paused"===a.state?"Resume":"Pause"},"play"),(0,p.jsx)(i.LinkButton,{variant:"secondary",href:n,icon:"cog",children:"Edit alert"},"edit")]})]})};var f,b,v=t("./.yarn/__virtual__/react-use-virtual-00326e70ba/3/opt/drone/yarncache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useLocalStorage.js");const j=()=>{const[e,a]=(0,v.Z)("grafana.legacyalerting.unifiedalertingpromo",!0);return e?(0,p.jsxs)(i.Alert,{severity:"info",title:"Try out the Grafana 8 alerting!",onRemove:()=>a(!1),children:[f||(f=(0,p.jsxs)("p",{children:["You are using the legacy Grafana alerting.",(0,p.jsx)("br",{}),"While we have no plans of deprecating it any time soon, we invite you to give the improved Grafana 8 alerting a try."]})),b||(b=(0,p.jsxs)("p",{children:["See"," ",(0,p.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/alerting/unified-alerting/difference-old-new/",children:"What’s New with Grafana 8 alerting"})," ","to learn more about what‘s new in Grafana 8 alerting or learn"," ",(0,p.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/alerting/unified-alerting/opt-in/",children:"how to enable the new Grafana 8 alerting feature"}),"."]}))]}):null};var y=t("./public/app/features/alerting/state/actions.ts"),_=t("./public/app/features/alerting/state/reducers.ts");const S=e=>e.searchQuery,w=e=>{const a=new RegExp(e.alertRules.searchQuery,"i");return e.alertRules.items.filter((e=>a.test(e.name)||a.test(e.stateText)||a.test(e.info)))};var C,R,N,k;function A(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}const $={getAlertRulesAsync:y.Au,setSearchQuery:_.ql,togglePauseAlertRule:y.en},F=(0,n.connect)((function(e){return{navModel:(0,u.h)(e.navIndex,"alert-list"),alertRules:w(e),search:S(e.alertRules),isLoading:e.alertRules.isLoading}}),$);class z extends s.PureComponent{constructor(){super(...arguments),A(this,"stateFilters",[{label:"All",value:"all"},{label:"OK",value:"ok"},{label:"Not OK",value:"not_ok"},{label:"Alerting",value:"alerting"},{label:"No data",value:"no_data"},{label:"Paused",value:"paused"},{label:"Pending",value:"pending"}]),A(this,"onStateFilterChanged",(e=>{l.locationService.partial({state:e.value})})),A(this,"onOpenHowTo",(()=>{o.Z.publish(new d.Dn({component:m}))})),A(this,"onSearchQueryChange",(e=>{this.props.setSearchQuery(e)})),A(this,"onTogglePause",(e=>{this.props.togglePauseAlertRule(e.id,{paused:"paused"!==e.state})})),A(this,"alertStateFilterOption",(e=>{let{text:a,value:t}=e;return(0,p.jsx)("option",{value:t,children:a},t)}))}componentDidMount(){this.fetchRules()}componentDidUpdate(e){e.queryParams.state!==this.props.queryParams.state&&this.fetchRules()}async fetchRules(){await this.props.getAlertRulesAsync({state:this.getStateFilter()})}getStateFilter(){var e;return null!==(e=this.props.queryParams.state)&&void 0!==e?e:"all"}render(){const{navModel:e,alertRules:a,search:t,isLoading:r}=this.props;return(0,p.jsx)(c.Z,{navModel:e,children:(0,p.jsxs)(c.Z.Contents,{isLoading:r,children:[(0,p.jsxs)("div",{className:"page-action-bar",children:[(0,p.jsx)("div",{className:"gf-form gf-form--grow",children:(0,p.jsx)(i.FilterInput,{placeholder:"Search alerts",value:t,onChange:this.onSearchQueryChange})}),(0,p.jsxs)("div",{className:"gf-form",children:[C||(C=(0,p.jsx)("label",{className:"gf-form-label",htmlFor:"alert-state-filter",children:"States"})),(0,p.jsx)("div",{className:"width-13",children:(0,p.jsx)(i.Select,{inputId:"alert-state-filter",menuShouldPortal:!0,options:this.stateFilters,onChange:this.onStateFilterChanged,value:this.getStateFilter()})})]}),R||(R=(0,p.jsx)("div",{className:"page-action-bar__spacer"})),l.config.unifiedAlertingEnabled&&(N||(N=(0,p.jsx)(i.LinkButton,{variant:"primary",href:"alerting/ng/new",children:"Add NG Alert"}))),(0,p.jsx)(i.Button,{variant:"secondary",onClick:this.onOpenHowTo,children:"How to add an alert"})]}),k||(k=(0,p.jsx)(j,{})),(0,p.jsx)(i.VerticalGroup,{spacing:"none",children:a.map((e=>(0,p.jsx)(x,{rule:e,search:t,onTogglePause:()=>this.onTogglePause(e)},e.id)))})]})})}}const T=F(z)},"./public/app/features/alerting/state/actions.ts":(e,a,t)=>{t.d(a,{Au:()=>i,C2:()=>c,c1:()=>d,en:()=>o,fA:()=>p,fg:()=>u,tk:()=>m});var r=t("./packages/grafana-runtime/src/index.ts"),s=t("./public/app/core/actions/index.ts"),n=t("./public/app/core/copy/appNotification.ts"),l=t("./public/app/features/alerting/state/reducers.ts");function i(e){return async a=>{a((0,l.gz)());const t=await(0,r.getBackendSrv)().get("/api/alerts",e);a((0,l.Oc)(t))}}function o(e,a){return async t=>{await(0,r.getBackendSrv)().post(`/api/alerts/${e}/pause`,a);t(i({state:(r.locationService.getSearchObject().state||"all").toString()}))}}function c(e){return async a=>{try{await(0,r.getBackendSrv)().post("/api/alert-notifications",e),a((0,s.$l)((0,n.AT)("Notification created"))),r.locationService.push("/alerting/notifications")}catch(e){a((0,s.$l)((0,n.t_)(e.data.error)))}}}function u(e){return async a=>{try{await(0,r.getBackendSrv)().put(`/api/alert-notifications/${e.id}`,e),a((0,s.$l)((0,n.AT)("Notification updated")))}catch(e){a((0,s.$l)((0,n.t_)(e.data.error)))}}}function d(e){return async(a,t)=>{const s=t().notificationChannel.notificationChannel;await(0,r.getBackendSrv)().post("/api/alert-notifications/test",Object.assign({id:s.id},e))}}function p(){return async e=>{const a=(await(0,r.getBackendSrv)().get("/api/alert-notifiers")).sort(((e,a)=>e.name>a.name?1:-1));e((0,l.T2)(a))}}function m(e){return async a=>{await a(p());const t=await(0,r.getBackendSrv)().get(`/api/alert-notifications/${e}`);a((0,l.K)(t))}}},"./public/app/features/alerting/unified/RuleList.tsx":(e,a,t)=>{t.r(a),t.d(a,{default:()=>Ee});var r,s,n=t("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/3/opt/drone/yarncache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),l=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),i=t("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/3/opt/drone/yarncache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),o=t("./.yarn/__virtual__/react-router-virtual-31642fe47a/3/opt/drone/yarncache/react-router-npm-5.2.1-ea754d7473-7daae084bf.zip/node_modules/react-router/esm/react-router.js"),c=t("./packages/grafana-data/src/index.ts"),u=t("./packages/grafana-ui/src/index.ts"),d=t("./public/app/core/hooks/useQueryParams.ts"),p=t("./public/app/features/alerting/unified/components/AlertingPageWrapper.tsx"),m=t("./public/app/core/components/EmptyListCTA/EmptyListCTA.tsx"),g=t("./public/app/features/alerting/unified/utils/accessControlHooks.ts"),h=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const x=()=>{const{canCreateGrafanaRules:e,canCreateCloudRules:a}=(0,g.B)();return e||a?r||(r=(0,h.jsx)(m.Z,{title:"You haven`t created any alert rules yet",buttonIcon:"bell",buttonLink:"alerting/new",buttonTitle:"New alert rule",proTip:"you can also create alert rules from existing panels and queries.",proTipLink:"https://grafana.com/docs/",proTipLinkTitle:"Learn more",proTipTarget:"_blank"})):s||(s=(0,h.jsx)(u.CallToActionCard,{message:"No rules exist yet.",callToActionElement:(0,h.jsx)("div",{})}))};var f=t("../../opt/drone/yarncache/pluralize-npm-8.0.0-f5f044ed52-08931d4a6a.zip/node_modules/pluralize/pluralize.js"),b=t.n(f),v=t("./.yarn/__virtual__/react-use-virtual-00326e70ba/3/opt/drone/yarncache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useLocalStorage.js"),j=t("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts"),y=t("./public/app/features/alerting/unified/utils/datasource.ts"),_=t("./public/app/features/alerting/unified/utils/rules.ts");function S(){const[e,a]=(0,l.useState)(!1),[t,r]=(0,v.Z)("grafana.unifiedalerting.hideErrors",!1),s=(0,j._)((e=>e.dataSources)),n=(0,j._)((e=>e.promRules)),i=(0,j._)((e=>e.rulerRules)),o=(0,u.useStyles2)(C),c=(0,l.useMemo)((()=>{var e,a;const[t,r,l]=[s,n,i].map((e=>(0,y.Eu)().reduce(((a,t)=>{var r;const s=null===(r=e[t.name])||void 0===r?void 0:r.error;return e[t.name]&&s&&!(0,_.m$)(e[t.name])?[...a,{dataSource:t,error:s}]:a}),[]))),o=null===(e=n[y.GC])||void 0===e?void 0:e.error,c=null===(a=i[y.GC])||void 0===a?void 0:a.error,u=[];return o&&u.push((0,h.jsxs)(h.Fragment,{children:["Failed to load Grafana rules state: ",o.message||"Unknown error."]})),c&&u.push((0,h.jsxs)(h.Fragment,{children:["Failed to load Grafana rules config: ",c.message||"Unknown error."]})),t.forEach((e=>{let{dataSource:a,error:t}=e;u.push((0,h.jsxs)(h.Fragment,{children:["Failed to load the data source configuration for"," ",(0,h.jsx)("a",{href:`datasources/edit/${a.uid}`,children:a.name}),": ",t.message||"Unknown error."]}))})),r.forEach((e=>{let{dataSource:a,error:t}=e;return u.push((0,h.jsxs)(h.Fragment,{children:["Failed to load rules state from ",(0,h.jsx)("a",{href:`datasources/edit/${a.uid}`,children:a.name}),":"," ",t.message||"Unknown error."]}))})),l.forEach((e=>{let{dataSource:a,error:t}=e;return u.push((0,h.jsxs)(h.Fragment,{children:["Failed to load rules config from ",(0,h.jsx)("a",{href:`datasources/edit/${a.uid}`,children:a.name}),":"," ",t.message||"Unknown error."]}))})),u}),[s,n,i]);return(0,h.jsxs)(h.Fragment,{children:[!!c.length&&t&&(0,h.jsx)(w,{count:c.length,onClick:()=>r((e=>!e))}),!!c.length&&!t&&(0,h.jsxs)(u.Alert,{"data-testid":"cloud-rulessource-errors",title:"Errors loading rules",severity:"error",onRemove:()=>r(!0),children:[e&&c.map(((e,a)=>(0,h.jsx)("div",{children:e},a))),!e&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{children:c[0]}),c.length>=2&&(0,h.jsxs)(u.Button,{className:o.moreButton,fill:"text",icon:"angle-right",size:"sm",onClick:()=>a(!0),children:[c.length-1," more ",b()("error",c.length-1)]})]})]})]})}const w=e=>{let{count:a,onClick:t}=e;const r=(0,u.useStyles2)(C);return(0,h.jsx)("div",{className:r.floatRight,children:(0,h.jsx)(u.Tooltip,{content:"Show all errors",placement:"bottom",children:(0,h.jsx)(u.Button,{fill:"text",variant:"destructive",icon:"exclamation-triangle",onClick:t,children:a>1?(0,h.jsxs)(h.Fragment,{children:[a," errors"]}):(0,h.jsx)(h.Fragment,{children:"1 error"})})})})},C=e=>({moreButton:n.css`
    padding: 0;
  `,floatRight:n.css`
    display: flex;
    justify-content: flex-end;
  `});var R=t("./public/app/types/index.ts"),N=t("./public/app/features/alerting/unified/components/Authorize.tsx"),k=t("./public/app/core/services/context_srv.ts"),A=t("./public/app/core/utils/kbn.ts"),$=t("./public/app/features/alerting/unified/hooks/useFolder.ts"),F=t("./public/app/features/alerting/unified/hooks/useHasRuler.ts"),z=t("./public/app/features/alerting/unified/state/actions.ts"),T=t("./public/app/features/alerting/unified/components/CollapseToggle.tsx"),I=t("./public/app/features/alerting/unified/components/RuleLocation.tsx"),G=t("./public/app/features/alerting/unified/components/rules/ActionIcon.tsx"),L=t("./public/app/core/hooks/useCleanup.ts"),P=t("./public/app/features/alerting/unified/utils/redux.ts"),B=t("./public/app/features/alerting/unified/utils/time.ts");function E(e){var a,t;const{namespace:r,group:s,onClose:n}=e,o=(0,u.useStyles2)(O),c=(0,i.useDispatch)(),{loading:d,error:p,dispatched:m}=null!==(a=(0,j._)((e=>e.updateLotexNamespaceAndGroup)))&&void 0!==a?a:P.oq,g=(0,l.useMemo)((()=>{var e;return{namespaceName:r.name,groupName:s.name,groupInterval:null!==(e=s.interval)&&void 0!==e?e:""}}),[r,s]);(0,l.useEffect)((()=>{!m||d||p||n()}),[m,d,n,p]),(0,L.x)((e=>e.unifiedAlerting.updateLotexNamespaceAndGroup));return(0,h.jsx)(u.Modal,{className:o.modal,isOpen:!0,title:"Edit namespace or rule group",onDismiss:n,onClickBackdrop:n,children:(0,h.jsx)(u.Form,{defaultValues:g,onSubmit:e=>{c((0,z.hv)({rulesSourceName:(0,y.EG)(r.rulesSource),groupName:s.name,newGroupName:e.groupName,namespaceName:r.name,newNamespaceName:e.namespaceName,groupInterval:e.groupInterval||void 0}))},children:e=>{var a,r,s;let{register:l,errors:i,formState:{isDirty:o}}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(u.Field,{label:"Namespace",invalid:!!i.namespaceName,error:null===(a=i.namespaceName)||void 0===a?void 0:a.message,children:(0,h.jsx)(u.Input,Object.assign({id:"namespaceName"},l("namespaceName",{required:"Namespace name is required."})))}),(0,h.jsx)(u.Field,{label:"Rule group",invalid:!!i.groupName,error:null===(r=i.groupName)||void 0===r?void 0:r.message,children:(0,h.jsx)(u.Input,Object.assign({id:"groupName"},l("groupName",{required:"Rule group name is required."})))}),(0,h.jsx)(u.Field,{label:"Rule group evaluation interval",invalid:!!i.groupInterval,error:null===(s=i.groupInterval)||void 0===s?void 0:s.message,children:(0,h.jsx)(u.Input,Object.assign({id:"groupInterval",placeholder:"1m"},l("groupInterval",{pattern:B.lR})))}),(0,h.jsxs)(u.Modal.ButtonRow,{children:[t||(t=(0,h.jsx)(u.Button,{variant:"secondary",type:"button",disabled:d,onClick:n,fill:"outline",children:"Close"})),(0,h.jsx)(u.Button,{type:"submit",disabled:!o||d,children:d?"Saving...":"Save changes"})]})]})}},JSON.stringify(g))})}const O=()=>({modal:n.css`
    max-width: 560px;
  `});var M=t("./public/app/types/unified-alerting-dto.ts");const D=e=>{let{children:a,status:t}=e;const r=(0,u.useStyles2)(q);return(0,h.jsx)("span",{className:r[t],children:a||t})},q=e=>({[M.x_.Inactive]:n.css`
    color: ${e.colors.success.text};
  `,[M.x_.Pending]:n.css`
    color: ${e.colors.warning.text};
  `,[M.x_.Firing]:n.css`
    color: ${e.colors.error.text};
  `,neutral:n.css`
    color: ${e.colors.text.secondary};
  `});var H,U;const W={total:0,recording:0,[M.x_.Firing]:0,[M.x_.Pending]:0,[M.x_.Inactive]:0,error:0},V=e=>{let{showInactive:a,showRecording:t,group:r,namespaces:s}=e;const n=(0,l.useMemo)((()=>{const e=Object.assign({},W),a=a=>{var t,r;a.promRule&&(0,_.x_)(a.promRule)&&(e[a.promRule.state]+=1),"err"!==(null===(t=a.promRule)||void 0===t?void 0:t.health)&&"error"!==(null===(r=a.promRule)||void 0===r?void 0:r.health)||(e.error+=1),(a.promRule&&(0,_.OP)(a.promRule)||a.rulerRule&&(0,_.yF)(a.rulerRule))&&(e.recording+=1),e.total+=1};return r&&r.rules.forEach(a),s&&s.forEach((e=>e.groups.forEach((e=>e.rules.forEach(a))))),e}),[r,s]),i=[];return n[M.x_.Firing]&&i.push((0,h.jsxs)(D,{status:M.x_.Firing,children:[n[M.x_.Firing]," firing"]},"firing")),n.error&&i.push((0,h.jsxs)(D,{status:M.x_.Firing,children:[n.error," errors"]},"errors")),n[M.x_.Pending]&&i.push((0,h.jsxs)(D,{status:M.x_.Pending,children:[n[M.x_.Pending]," pending"]},"pending")),a&&n[M.x_.Inactive]&&i.push((0,h.jsxs)(D,{status:"neutral",children:[n[M.x_.Inactive]," normal"]},"inactive")),t&&n.recording&&i.push((0,h.jsxs)(D,{status:"neutral",children:[n.recording," recording"]},"recording")),(0,h.jsxs)("div",{children:[(0,h.jsxs)("span",{children:[n.total," ",b()("rule",n.total)]}),!!i.length&&(0,h.jsxs)(h.Fragment,{children:[H||(H=(0,h.jsx)("span",{children:": "})),i.reduce(((e,a,t)=>e.length?[e,(0,h.jsx)(l.Fragment,{children:U||(U=(0,h.jsx)("span",{children:", "}))},t),a]:[a]),[])]})]})};var Z,K,Q,J,Y=t("./public/app/features/alerting/unified/components/rules/RulesTable.tsx");const X=l.memo((e=>{var a;let{group:t,namespace:r,expandAll:s}=e;const{rulesSource:n}=r,o=(0,i.useDispatch)(),c=(0,u.useStyles2)(ee),[d,p]=(0,l.useState)(!1),[m,g]=(0,l.useState)(!1),[x,f]=(0,l.useState)(!s),v=k.Vt.hasPermission(R.bW.AlertingRuleExternalWrite);(0,l.useEffect)((()=>{f(!s)}),[s]);const j=(0,F.h)(),S=null===(a=t.rules[0])||void 0===a?void 0:a.rulerRule,w=S&&(0,_.Pc)(S)&&S.grafana_alert.namespace_uid||void 0,{folder:C}=(0,$.W)(w),N=j(n)&&!t.rules.find((e=>!!e.rulerRule)),L=(0,_.Jq)(t),P=[];if(N)P.push(Z||(Z=(0,h.jsxs)(u.HorizontalGroup,{children:[(0,h.jsx)(u.Spinner,{}),"deleting"]},"is-deleting")));else if(n===y.GC){if(w){const e=`/dashboards/f/${w}/${A.Z.slugifyForUrl(r.name)}`;null!=C&&C.canSave&&P.push((0,h.jsx)(G.A,{"aria-label":"edit folder",icon:"pen",tooltip:"edit folder",to:e+"/settings",target:"__blank"},"edit")),null!=C&&C.canAdmin&&P.push((0,h.jsx)(G.A,{"aria-label":"manage permissions",icon:"lock",tooltip:"manage permissions",to:e+"/permissions",target:"__blank"},"manage-perms"))}}else v&&j(n)&&(L||P.push((0,h.jsx)(G.A,{"aria-label":"edit rule group","data-testid":"edit-group",icon:"pen",tooltip:"edit rule group",onClick:()=>p(!0)},"edit")),P.push((0,h.jsx)(G.A,{"aria-label":"delete rule group","data-testid":"delete-group",icon:"trash-alt",tooltip:"delete rule group",onClick:()=>g(!0)},"delete-group")));const B="default"===t.name?(0,h.jsx)(I.V,{namespace:r.name}):(0,h.jsx)(I.V,{namespace:r.name,group:t.name});return(0,h.jsxs)("div",{className:c.wrapper,"data-testid":"rule-group",children:[(0,h.jsxs)("div",{className:c.header,"data-testid":"rule-group-header",children:[(0,h.jsx)(T.U,{className:c.collapseToggle,isCollapsed:x,onToggle:f,"data-testid":"group-collapse-toggle"}),(0,h.jsx)(u.Icon,{name:x?"folder":"folder-open"}),(0,y.jq)(n)&&(0,h.jsx)(u.Tooltip,{content:n.name,placement:"top",children:(0,h.jsx)("img",{alt:n.meta.name,className:c.dataSourceIcon,src:n.meta.info.logos.small})}),(0,h.jsxs)("h6",{className:c.heading,children:[L&&(K||(K=(0,h.jsx)(u.Badge,{color:"purple",text:"Federated"})))," ",B]}),(0,h.jsx)("div",{className:c.spacer}),(0,h.jsx)("div",{className:c.headerStats,children:(0,h.jsx)(V,{showInactive:!1,group:t})}),!!P.length&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:c.actionsSeparator,children:"|"}),(0,h.jsx)("div",{className:c.actionIcons,children:P})]})]}),!x&&(0,h.jsx)(Y.i,{showSummaryColumn:!0,className:c.rulesTable,showGuidelines:!0,rules:t.rules}),d&&(0,h.jsx)(E,{group:t,namespace:r,onClose:()=>p(!1)}),(0,h.jsx)(u.ConfirmModal,{isOpen:m,title:"Delete group",body:(0,h.jsxs)("div",{children:["Deleting this group will permanently remove the group",Q||(Q=(0,h.jsx)("br",{})),"and ",t.rules.length," alert ",b()("rule",t.rules.length)," belonging to it.",J||(J=(0,h.jsx)("br",{})),"Are you sure you want to delete this group?"]}),onConfirm:()=>{o((0,z.oE)(r,t)),g(!1)},onDismiss:()=>g(!1),confirmText:"Delete"})]})}));X.displayName="RulesGroup";const ee=e=>({wrapper:n.css`
    & + & {
      margin-top: ${e.spacing(2)};
    }
  `,header:n.css`
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: ${e.spacing(1)} ${e.spacing(1)} ${e.spacing(1)} 0;
    background-color: ${e.colors.background.secondary};
    flex-wrap: wrap;
  `,headerStats:n.css`
    span {
      vertical-align: middle;
    }

    ${e.breakpoints.down("sm")} {
      order: 2;
      width: 100%;
      padding-left: ${e.spacing(1)};
    }
  `,heading:n.css`
    margin-left: ${e.spacing(1)};
    margin-bottom: 0;
  `,spacer:n.css`
    flex: 1;
  `,collapseToggle:n.css`
    background: none;
    border: none;
    margin-top: -${e.spacing(1)};
    margin-bottom: -${e.spacing(1)};

    svg {
      margin-bottom: 0;
    }
  `,dataSourceIcon:n.css`
    width: ${e.spacing(2)};
    height: ${e.spacing(2)};
    margin-left: ${e.spacing(2)};
  `,dataSourceOrigin:n.css`
    margin-right: 1em;
    color: ${e.colors.text.disabled};
  `,actionsSeparator:n.css`
    margin: 0 ${e.spacing(2)};
  `,actionIcons:n.css`
    & > * + * {
      margin-left: ${e.spacing(.5)};
    }
  `,rulesTable:n.css`
    margin-top: ${e.spacing(3)};
  `});var ae,te,re,se;const ne=e=>{let{namespaces:a,expandAll:t}=e;const r=(0,u.useStyles)(le),s=(0,j._)((e=>e.promRules)),n=(0,l.useMemo)(y.Eu,[]),i=(0,l.useMemo)((()=>n.filter((e=>{var a;return null===(a=s[e.name])||void 0===a?void 0:a.loading}))),[s,n]);return(0,h.jsxs)("section",{className:r.wrapper,children:[(0,h.jsxs)("div",{className:r.sectionHeader,children:[ae||(ae=(0,h.jsx)("h5",{children:"Mimir / Cortex / Loki"})),i.length?(0,h.jsx)(u.LoadingPlaceholder,{className:r.loader,text:`Loading rules from ${i.length} ${b()("source",i.length)}`}):te||(te=(0,h.jsx)("div",{}))]}),a.map((e=>{const{groups:a,rulesSource:r}=e;return a.map((a=>(0,h.jsx)(X,{group:a,namespace:e,expandAll:t},`${(0,y.EG)(r)}-${name}-${a.name}`)))})),0===(null==a?void 0:a.length)&&!!n.length&&(re||(re=(0,h.jsx)("p",{children:"No rules found."}))),!n.length&&(se||(se=(0,h.jsx)("p",{children:"There are no Prometheus or Loki datas sources configured."})))]})},le=e=>({loader:n.css`
    margin-bottom: 0;
  `,sectionHeader:n.css`
    display: flex;
    justify-content: space-between;
  `,wrapper:n.css`
    margin-bottom: ${e.spacing.xl};
  `});var ie,oe,ce,ue=t("./public/app/features/alerting/unified/hooks/useCombinedRuleNamespaces.ts");const de=e=>{let{namespaces:a,expandAll:t}=e;const r=(0,u.useStyles)(pe),[s]=(0,d.K)(),{loading:n}=(0,j._)((e=>e.promRules[y.GC]||P.oq)),l="grouped"===s.view?a:(0,ue.Kd)(a);return(0,h.jsxs)("section",{className:r.wrapper,children:[(0,h.jsxs)("div",{className:r.sectionHeader,children:[ie||(ie=(0,h.jsx)("h5",{children:"Grafana"})),n?(0,h.jsx)(u.LoadingPlaceholder,{className:r.loader,text:"Loading..."}):oe||(oe=(0,h.jsx)("div",{}))]}),null==l?void 0:l.map((e=>e.groups.map((a=>(0,h.jsx)(X,{group:a,namespace:e,expandAll:t},`${e.name}-${a.name}`))))),0===(null==l?void 0:l.length)&&(ce||(ce=(0,h.jsx)("p",{children:"No rules found."})))]})},pe=e=>({loader:n.css`
    margin-bottom: 0;
  `,sectionHeader:n.css`
    display: flex;
    justify-content: space-between;
  `,wrapper:n.css`
    margin-bottom: ${e.spacing.xl};
  `});var me=t("./public/app/features/alerting/unified/utils/misc.ts");const ge=e=>{let{rules:a,state:t,defaultCollapsed:r=!1}=e;const[s,n]=(0,l.useState)(r),i=(0,u.useStyles2)(he);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("h4",{className:i.header,children:[(0,h.jsx)(T.U,{className:i.collapseToggle,size:"xxl",isCollapsed:s,onToggle:()=>n(!s)}),(0,_.SS)(t)," (",a.length,")"]}),!s&&(0,h.jsx)(Y.i,{className:i.rulesTable,rules:a,showGroupColumn:!0})]})},he=e=>({collapseToggle:n.css`
    vertical-align: middle;
  `,header:n.css`
    margin-top: ${e.spacing(2)};
  `,rulesTable:n.css`
    margin-top: ${e.spacing(3)};
  `});var xe,fe,be,ve,je,ye=t("../../opt/drone/yarncache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js"),_e=t("./.yarn/__virtual__/@grafana-experimental-virtual-920bad95a1/3/opt/drone/yarncache/@grafana-experimental-npm-0.0.2-canary.22-45d2c4f135-b9a64c0abc.zip/node_modules/@grafana/experimental/index.js"),Se=t("./packages/grafana-runtime/src/index.ts");const we=[{icon:"list-ul",label:"List",value:"list"},{icon:"folder",label:"Grouped",value:"grouped"},{icon:"heart-rate",label:"State",value:"state"}],Ce=[{label:"Alert ",value:M.pz.Alerting},{label:"Recording ",value:M.pz.Recording}],Re=e=>({container:n.css`
      display: flex;
      flex-direction: column;
      padding-bottom: ${e.spacing.sm};
      margin-bottom: ${e.spacing.sm};
    `,inputWidth:n.css`
      width: 340px;
      flex-grow: 0;
    `,flexRow:n.css`
      display: flex;
      flex-direction: row;
      align-items: flex-end;
      width: 100%;
      flex-wrap: wrap;
    `,spaceBetween:n.css`
      justify-content: space-between;
    `,rowChild:n.css`
      margin: 0 ${e.spacing.sm} 0 0;
    `,clearButton:n.css`
      margin-top: ${e.spacing.sm};
    `}),Ne=()=>{var e;const[a,t]=(0,d.K)(),[r,s]=(0,l.useState)(Math.floor(100*Math.random())),i=`dataSource-${r}`,o=`queryString-${r}`,{dataSource:c,alertState:p,queryString:m,ruleType:g}=(0,me.lC)(a),x=(0,u.useStyles)(Re),f=Object.entries(M.x_).map((e=>{let[a,t]=e;return{label:(0,_.SS)(t),value:t}})),b=(0,ye.debounce)((e=>{const a=e.target;t({queryString:a.value||null})}),600),v=xe||(xe=(0,h.jsx)(u.Icon,{name:"search"}));return(0,h.jsxs)("div",{className:x.container,children:[(0,h.jsx)(u.Field,{className:x.inputWidth,label:"Search by data source",children:(0,h.jsx)(Se.DataSourcePicker,{alerting:!0,noDefault:!0,placeholder:"All data sources",current:c,onChange:e=>{t({dataSource:e.name})},onClear:()=>{t({dataSource:null})}},i)}),(0,h.jsxs)("div",{className:(0,n.cx)(x.flexRow,x.spaceBetween),children:[(0,h.jsxs)("div",{className:x.flexRow,children:[(0,h.jsx)(u.Field,{className:x.rowChild,label:fe||(fe=(0,h.jsx)(u.Label,{children:(0,h.jsxs)(_e.Stack,{gap:.5,children:[(0,h.jsx)("span",{children:"Search by label"}),(0,h.jsx)(u.Tooltip,{content:(0,h.jsxs)("div",{children:["Filter rules and alerts using label querying, ex:",(0,h.jsx)("code",{children:'{severity="critical", instance=~"cluster-us-.+"}'})]}),children:(0,h.jsx)(u.Icon,{name:"info-circle",size:"sm"})})]})})),children:(0,h.jsx)(u.Input,{className:x.inputWidth,prefix:v,onChange:b,defaultValue:m,placeholder:"Search","data-testid":"search-query-input"},o)}),(0,h.jsxs)("div",{className:x.rowChild,children:[be||(be=(0,h.jsx)(u.Label,{children:"State"})),(0,h.jsx)(u.RadioButtonGroup,{options:f,value:p,onChange:e=>{t({alertState:e})}})]}),(0,h.jsxs)("div",{className:x.rowChild,children:[ve||(ve=(0,h.jsx)(u.Label,{children:"Rule type"})),(0,h.jsx)(u.RadioButtonGroup,{options:Ce,value:g,onChange:e=>{t({ruleType:e})}})]}),(0,h.jsxs)("div",{className:x.rowChild,children:[je||(je=(0,h.jsx)(u.Label,{children:"View as"})),(0,h.jsx)(u.RadioButtonGroup,{options:we,value:String(null!==(e=a.view)&&void 0!==e?e:we[0].value),onChange:e=>{t({view:e})}})]})]}),(c||p||m||g)&&(0,h.jsx)("div",{className:x.flexRow,children:(0,h.jsx)(u.Button,{className:x.clearButton,fullWidth:!1,icon:"times",variant:"secondary",onClick:()=>{t({alertState:null,queryString:null,dataSource:null,ruleType:null}),setTimeout((()=>s(r+1)),100)},children:"Clear filters"})})]})]})};var ke=t("./public/app/features/alerting/unified/utils/alertmanager.ts");const Ae=e=>(a,t)=>{const r=t.groups.reduce($e(e),[]);return r.length&&a.push(Object.assign({},t,{groups:r})),a},$e=e=>(a,t)=>{const r=t.rules.filter((a=>{var t;if(e.ruleType&&e.ruleType!==(null===(t=a.promRule)||void 0===t?void 0:t.type))return!1;if(e.dataSource&&(0,_.Pc)(a.rulerRule)&&!Fe(a.rulerRule,e))return!1;if(e.queryString){var r;const t=e.queryString.toLocaleLowerCase(),s=null===(r=a.name)||void 0===r?void 0:r.toLocaleLowerCase().includes(t),n=(0,ke.Zh)(e.queryString),l=(0,ke.eD)(a.labels,n),i=a.promRule&&a.promRule.type===M.pz.Alerting&&a.promRule.alerts&&a.promRule.alerts.some((e=>(0,ke.eD)(e.labels,n)));if(!(s||l||i))return!1}return!!(!e.alertState||a.promRule&&(0,_.x_)(a.promRule)&&a.promRule.state===e.alertState)}));return r.length&&a.push(Object.assign({},t,{rules:r})),a},Fe=(e,a)=>!a.dataSource||!!e.grafana_alert.data.find((e=>{if(!e.datasourceUid)return!1;const t=(0,Se.getDataSourceSrv)().getInstanceSettings(e.datasourceUid);return(null==t?void 0:t.name)===a.dataSource}));var ze,Te,Ie,Ge=t("./public/app/features/alerting/unified/utils/constants.ts");const Le={groups:e=>{let{namespaces:a,expandAll:t}=e;const[r,s]=(0,l.useMemo)((()=>{const e=a.map((e=>Object.assign({},e,{groups:e.groups.sort(((e,a)=>e.name.localeCompare(a.name)))}))).sort(((e,a)=>e.name.localeCompare(a.name)));return[e.filter((e=>(0,y.HY)(e.rulesSource))),e.filter((e=>(0,y.jq)(e.rulesSource)))]}),[a]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(N.q,{actions:[R.bW.AlertingRuleRead],children:(0,h.jsx)(de,{namespaces:r,expandAll:t})}),(0,h.jsx)(N.q,{actions:[R.bW.AlertingRuleExternalRead],children:(0,h.jsx)(ne,{namespaces:s,expandAll:t})})]})},state:e=>{let{namespaces:a}=e;const t=(0,me.lC)((0,d.K)()[0]),r=(0,l.useMemo)((()=>{const e={[M.x_.Firing]:[],[M.x_.Inactive]:[],[M.x_.Pending]:[]};return a.forEach((a=>a.groups.forEach((a=>a.rules.forEach((a=>{a.promRule&&(0,_.x_)(a.promRule)&&e[a.promRule.state].push(a)})))))),Object.values(e).forEach((e=>e.sort(((e,a)=>e.name.localeCompare(a.name))))),e}),[a]);return(0,h.jsxs)(h.Fragment,{children:[(!t.alertState||t.alertState===M.x_.Firing)&&(0,h.jsx)(ge,{state:M.x_.Firing,rules:r[M.x_.Firing]}),(!t.alertState||t.alertState===M.x_.Pending)&&(0,h.jsx)(ge,{state:M.x_.Pending,rules:r[M.x_.Pending]}),(!t.alertState||t.alertState===M.x_.Inactive)&&(0,h.jsx)(ge,{defaultCollapsed:t.alertState!==M.x_.Inactive,state:M.x_.Inactive,rules:r[M.x_.Inactive]})]})}},Pe=(0,u.withErrorBoundary)((()=>{const e=(0,i.useDispatch)(),a=(0,u.useStyles2)(Be),t=(0,l.useMemo)(y.mA,[]),r=(0,o.TH)(),[s,n]=(0,l.useState)(!1),[m]=(0,d.K)(),f=(0,me.lC)(m),b=Object.values(f).some((e=>void 0!==e)),{canCreateGrafanaRules:v,canCreateCloudRules:_}=(0,g.B)(),w=Le[m.view]?m.view:"groups",C=Le[w];(0,l.useEffect)((()=>{e((0,z.ei)());const a=setInterval((()=>e((0,z.ei)())),Ge.p4);return()=>{clearInterval(a)}}),[e]);const R=(0,j._)((e=>e.promRules)),N=(0,j._)((e=>e.rulerRules)),k=t.some((e=>{var a,t;return(null===(a=R[e])||void 0===a?void 0:a.dispatched)||(null===(t=N[e])||void 0===t?void 0:t.dispatched)})),A=t.some((e=>{var a,t;return(null===(a=R[e])||void 0===a?void 0:a.loading)||(null===(t=N[e])||void 0===t?void 0:t.loading)})),$=t.some((e=>{var a,t,r,s,n;return(null===(a=R[e])||void 0===a||null===(t=a.result)||void 0===t?void 0:t.length)&&!(null!==(r=R[e])&&void 0!==r&&r.error)||Object.keys((null===(s=N[e])||void 0===s?void 0:s.result)||{}).length&&!(null!==(n=N[e])&&void 0!==n&&n.error)})),F=k&&!A&&!$,T=(e=>{const[a]=(0,d.K)(),t=(0,me.lC)(a);return(0,l.useMemo)((()=>e.filter((e=>{let{rulesSource:a}=e;return!t.dataSource||!(0,y.jq)(a)||a.name===t.dataSource})).reduce(Ae(t),[])),[e,t])})((0,ue.Zo)());return(0,h.jsxs)(p.J,{pageId:"alert-list",isLoading:A&&!$,children:[ze||(ze=(0,h.jsx)(S,{})),!F&&(0,h.jsxs)(h.Fragment,{children:[Te||(Te=(0,h.jsx)(Ne,{})),(0,h.jsx)("div",{className:a.break}),(0,h.jsxs)("div",{className:a.buttonsContainer,children:[(0,h.jsxs)("div",{className:a.statsContainer,children:["groups"===w&&b&&(0,h.jsx)(u.Button,{className:a.expandAllButton,icon:s?"angle-double-up":"angle-double-down",variant:"secondary",onClick:()=>n(!s),children:s?"Collapse all":"Expand all"}),(0,h.jsx)(V,{showInactive:!0,showRecording:!0,namespaces:T})]}),(v||_)&&(0,h.jsx)(u.LinkButton,{href:c.urlUtil.renderUrl("alerting/new",{returnTo:r.pathname+r.search}),icon:"plus",children:"New alert rule"})]})]}),F&&(Ie||(Ie=(0,h.jsx)(x,{}))),$&&(0,h.jsx)(C,{expandAll:s,namespaces:T})]})}),{style:"page"}),Be=e=>({break:n.css`
    width: 100%;
    height: 0;
    margin-bottom: ${e.spacing(2)};
    border-bottom: solid 1px ${e.colors.border.medium};
  `,buttonsContainer:n.css`
    margin-bottom: ${e.spacing(2)};
    display: flex;
    justify-content: space-between;
  `,statsContainer:n.css`
    display: flex;
    flex-direction: row;
    align-items: center;
  `,expandAllButton:n.css`
    margin-right: ${e.spacing(1)};
  `}),Ee=Pe},"./public/app/features/alerting/unified/components/AlertingPageWrapper.tsx":(e,a,t)=>{t.d(a,{J:()=>i});t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var r=t("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/3/opt/drone/yarncache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),s=t("./public/app/core/components/Page/Page.tsx"),n=t("./public/app/core/selectors/navModel.ts"),l=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const i=e=>{let{children:a,pageId:t,isLoading:i}=e;const o=(0,n.h)((0,r.useSelector)((e=>e.navIndex)),t);return(0,l.jsx)(s.Z,{navModel:o,children:(0,l.jsx)(s.Z.Contents,{isLoading:i,children:a})})}},"./public/app/features/alerting/unified/components/Authorize.tsx":(e,a,t)=>{t.d(a,{q:()=>n});t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var r=t("./public/app/core/services/context_srv.ts"),s=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const n=e=>{let{actions:a,children:t,fallback:n=!0}=e;return a.some((e=>r.Vt.hasAccess(e,n)))?(0,s.jsx)(s.Fragment,{children:t}):null}},"./public/app/features/alerting/unified/components/DynamicTableWithGuidelines.tsx":(e,a,t)=>{t.d(a,{F:()=>o});var r=t("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/3/opt/drone/yarncache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),s=(t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),t("./packages/grafana-ui/src/index.ts")),n=t("./public/app/features/alerting/unified/components/DynamicTable.tsx"),l=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const i=["renderExpandedContent"];const o=e=>{let{renderExpandedContent:a}=e,t=function(e,a){if(null==e)return{};var t,r,s={},n=Object.keys(e);for(r=0;r<n.length;r++)t=n[r],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,i);const o=(0,s.useStyles2)(c);return(0,l.jsx)(n.t,Object.assign({renderExpandedContent:a?(e,t,s)=>(0,l.jsxs)(l.Fragment,{children:[!(t===s.length-1)&&(0,l.jsx)("div",{className:(0,r.cx)(o.contentGuideline,o.guideline)}),a(e,t,s)]}):void 0,renderPrefixHeader:()=>(0,l.jsx)("div",{className:o.relative,children:(0,l.jsx)("div",{className:(0,r.cx)(o.headerGuideline,o.guideline)})}),renderPrefixCell:(e,a,t)=>(0,l.jsxs)("div",{className:o.relative,children:[(0,l.jsx)("div",{className:(0,r.cx)(o.topGuideline,o.guideline)}),!(a===t.length-1)&&(0,l.jsx)("div",{className:(0,r.cx)(o.bottomGuideline,o.guideline)})]})},t))},c=e=>({relative:r.css`
    position: relative;
    height: 100%;
  `,guideline:r.css`
    left: -19px;
    border-left: 1px solid ${e.colors.border.medium};
    position: absolute;

    ${e.breakpoints.down("md")} {
      display: none;
    }
  `,topGuideline:r.css`
    width: 18px;
    border-bottom: 1px solid ${e.colors.border.medium};
    top: 0;
    bottom: 50%;
  `,bottomGuideline:r.css`
    top: 50%;
    bottom: 0;
  `,contentGuideline:r.css`
    top: 0;
    bottom: 0;
    left: -49px !important;
  `,headerGuideline:r.css`
    top: -25px;
    bottom: 0;
  `})},"./public/app/features/alerting/unified/components/RuleLocation.tsx":(e,a,t)=>{t.d(a,{V:()=>l});t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var r,s=t("./packages/grafana-ui/src/index.ts"),n=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const l=e=>{let{namespace:a,group:t}=e;return t?(0,n.jsxs)(n.Fragment,{children:[a," ",r||(r=(0,n.jsx)(s.Icon,{name:"angle-right"}))," ",t]}):(0,n.jsx)(n.Fragment,{children:a})}},"./public/app/features/alerting/unified/components/rules/ActionIcon.tsx":(e,a,t)=>{t.d(a,{A:()=>l});t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var r=t("./packages/grafana-ui/src/index.ts"),s=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const n=["tooltip","icon","to","target","onClick","className","tooltipPlacement"];const l=e=>{let{tooltip:a,icon:t,to:l,target:i,onClick:o,className:c,tooltipPlacement:u="top"}=e,d=function(e,a){if(null==e)return{};var t,r,s={},n=Object.keys(e);for(r=0;r<n.length;r++)t=n[r],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);const p="string"==typeof a?a:void 0;return(0,s.jsx)(r.Tooltip,{content:a,placement:u,children:l?(0,s.jsx)(r.LinkButton,Object.assign({variant:"secondary",fill:"text",icon:t,href:l,size:"sm",target:i},d,{"aria-label":p})):(0,s.jsx)(r.Button,Object.assign({className:c,variant:"secondary",fill:"text",size:"sm",icon:t,type:"button",onClick:o},d,{"aria-label":p}))})}},"./public/app/features/alerting/unified/components/rules/RulesTable.tsx":(e,a,t)=>{t.d(a,{i:()=>S});var r=t("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/3/opt/drone/yarncache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),s=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),n=t("./packages/grafana-ui/src/index.ts"),l=t("./public/app/features/alerting/unified/hooks/useHasRuler.ts"),i=t("./public/app/features/alerting/unified/utils/constants.ts"),o=t("./public/app/features/alerting/unified/components/DynamicTable.tsx"),c=t("./public/app/features/alerting/unified/components/DynamicTableWithGuidelines.tsx"),u=t("./public/app/features/alerting/unified/components/RuleLocation.tsx"),d=t("./public/app/features/alerting/unified/components/AlertLabels.tsx"),p=t("./public/app/features/alerting/unified/components/DetailsField.tsx"),m=t("./public/app/features/alerting/unified/components/rules/RuleDetailsActionButtons.tsx"),g=t("./public/app/features/alerting/unified/components/rules/RuleDetailsAnnotations.tsx"),h=t("./public/app/features/alerting/unified/components/rules/RuleDetailsDataSources.tsx"),x=t("./public/app/features/alerting/unified/components/rules/RuleDetailsExpression.tsx"),f=t("./public/app/features/alerting/unified/components/rules/RuleDetailsMatchingInstances.tsx"),b=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const v=e=>{let{rule:a}=e;const t=(0,n.useStyles2)(j),{promRule:r,namespace:{rulesSource:s}}=a,l=Object.entries(a.annotations).filter((e=>{let[a,t]=e;return!!t.trim()}));return(0,b.jsxs)("div",{children:[(0,b.jsx)(m.f,{rule:a,rulesSource:s}),(0,b.jsxs)("div",{className:t.wrapper,children:[(0,b.jsxs)("div",{className:t.leftSide,children:[!!a.labels&&!!Object.keys(a.labels).length&&(0,b.jsx)(p.C,{label:"Labels",horizontal:!0,children:(0,b.jsx)(d.s,{labels:a.labels})}),(0,b.jsx)(x.C,{rulesSource:s,rule:a,annotations:l}),(0,b.jsx)(g.J,{annotations:l})]}),(0,b.jsx)("div",{className:t.rightSide,children:(0,b.jsx)(h.C,{rulesSource:s,rule:a})})]}),(0,b.jsx)(f.M,{promRule:r})]})},j=e=>({wrapper:r.css`
    display: flex;
    flex-direction: row;
    ${e.breakpoints.down("md")} {
      flex-direction: column;
    }
  `,leftSide:r.css`
    flex: 1;
  `,rightSide:r.css`
    ${e.breakpoints.up("md")} {
      padding-left: 90px;
      width: 300px;
    }
  `});var y=t("./public/app/features/alerting/unified/components/rules/RuleHealth.tsx"),_=t("./public/app/features/alerting/unified/components/rules/RuleState.tsx");const S=e=>{let{rules:a,className:t,showGuidelines:d=!1,emptyMessage:p="No rules found.",showGroupColumn:m=!1,showSummaryColumn:g=!1}=e;const h=(0,n.useStyles2)(w),x=(0,r.cx)(h.wrapper,t,{[h.wrapperMargin]:d}),f=(0,s.useMemo)((()=>{const e=[];return a.map(((a,t)=>{var r;let s=JSON.stringify([null===(r=a.promRule)||void 0===r?void 0:r.type,a.labels,a.query,a.name,a.annotations]);return e.includes(s)&&(s+=`-${t}`),e.push(s),{id:s,data:a}}))}),[a]),j=function(e,a){const t=(0,l.h)();return(0,s.useMemo)((()=>{const r=[{id:"state",label:"State",renderCell:e=>{let{data:a}=e;const{namespace:r}=a,{rulesSource:s}=r,{promRule:n,rulerRule:l}=a,i=!(!t(s)||!n||l),o=!(!t(s)||!l||n);return(0,b.jsx)(_.p,{rule:a,isDeleting:i,isCreating:o})},size:"165px"},{id:"name",label:"Name",renderCell:e=>{let{data:a}=e;return a.name},size:5},{id:"health",label:"Health",renderCell:e=>{let{data:{promRule:a}}=e;return a?(0,b.jsx)(y.V,{rule:a}):null},size:"75px"}];return e&&r.push({id:"summary",label:"Summary",renderCell:e=>{var a;let{data:t}=e;return null!==(a=t.annotations[i.q6.summary])&&void 0!==a?a:""},size:5}),a&&r.push({id:"group",label:"Group",renderCell:e=>{let{data:a}=e;const{namespace:t,group:r}=a;return"default"===r.name?(0,b.jsx)(u.V,{namespace:t.name}):(0,b.jsx)(u.V,{namespace:t.name,group:r.name})},size:5}),r}),[t,e,a])}(g,m);if(!a.length)return(0,b.jsx)("div",{className:(0,r.cx)(x,h.emptyMessage),children:p});const S=d?c.F:o.t;return(0,b.jsx)("div",{className:x,"data-testid":"rules-table",children:(0,b.jsx)(S,{cols:j,isExpandable:!0,items:f,renderExpandedContent:e=>{let{data:a}=e;return(0,b.jsx)(v,{rule:a})}})})},w=e=>({wrapperMargin:r.css`
    ${e.breakpoints.up("md")} {
      margin-left: 36px;
    }
  `,emptyMessage:r.css`
    padding: ${e.spacing(1)};
  `,wrapper:r.css`
    width: auto;
    background-color: ${e.colors.background.secondary};
    border-radius: ${e.shape.borderRadius()};
  `})},"./public/app/features/alerting/unified/hooks/useHasRuler.ts":(e,a,t)=>{t.d(a,{h:()=>l});var r=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),s=t("./public/app/features/alerting/unified/utils/datasource.ts"),n=t("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts");function l(){const e=(0,n._)((e=>e.rulerRules));return(0,r.useCallback)((a=>{var t;const r="string"==typeof a?a:a.name;return r===s.GC||!(null===(t=e[r])||void 0===t||!t.result)}),[e])}},"./public/app/features/alerting/unified/utils/accessControlHooks.ts":(e,a,t)=>{t.d(a,{B:()=>n});var r=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),s=t("./public/app/features/alerting/unified/utils/access-control.ts");function n(){return(0,r.useMemo)((()=>(0,s.Rv)()),[])}}}]);
//# sourceMappingURL=AlertRuleListIndex.b208037f6b1954dc031d.js.map